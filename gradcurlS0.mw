@function [curlj,gradrho] = gradcurlS0(norders,ixyzs,iptype,srccoefs,srcvals,targs,ipatch_id,uvs_targ,eps,rjvec,rho)
%GRADCURLS0 compute grad S0[rho] and curl S0[J]

npatches = length(norders);
npts = size(srccoefs,2);
[ndtarg,ntarg] = size(targs);
npatchesplusone = npatches+1;

# FORTRAN lpcomp_virtualcasing(int[1] npatches, int[npatches] norders, int[npatchesplusone] ixyzs, int[npatches] iptype, int[1] npts, double[9,npts] srccoefs, double[12,npts] srcvals, int[1] ndtarg, int[1] ntarg, double[ndtarg,ntarg] targs, int[ntarg] ipatch_id, double[2,ntarg] uvs_targ, double[1] eps, double[3,npts] rjvec, double[npts] rho, inout double[3,npts] curlj, inout double[3,npts] gradrho);

end